$(document).ready(function(){$.fn.serializeFormJSON=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},$.fn.postageState=function(e){$viewState={},$container=this.closest(".postage"),$viewState.ready=$container.find(".ready"),$viewState.sending=$container.find(".sending"),$viewState.sent=$container.find(".sent"),$viewState.failure=$container.find(".failure"),$.each($viewState,function(t,a){t==e?a.removeClass("hidden"):a.addClass("hidden")})},$.fn.sendWithPostage=function(){if($form=$(this),$form.valid()){var e=$form.serializeFormJSON(),t="http://entio-postage.herokuapp.com/messages/send.json?callback=?";$form.postageState("sending"),$.ajax({type:"POST",url:t,async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",data:e,success:function(e){console.log(e),$form.postageState("sent"),$form.validate().resetForm()},error:function(e){console.log(e.message),$form.postageState("failure")}})}},$("button.show-contact-form").bind("click",function(){$(this).postageState("ready")})});